# 业绩追踪系统

一个基于PyQt5的业绩数据管理和可视化系统，支持多时期数据录入、编号管理、姓名管理和图表展示。

## 🚀 快速开始

### 环境要求
- Python 3.8 或更高版本
- PyQt5 界面库
- matplotlib 图表库

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
# 启动主应用程序
python main.py
```

## 📁 项目结构

```
pygui38/                     # 项目根目录
├── main.py                  # 🚀 应用程序主入口
├── database.py              # 📊 数据库管理核心模块
├── ui/                      # 🖥️ 用户界面模块
│   ├── __init__.py         #    UI包初始化文件
│   ├── main_window.py      #    主窗口界面组件
│   ├── data_entry_tab.py   #    数据录入界面组件
│   └── charts_tab.py        #    图表显示界面组件
├── README.md               # 📖 项目说明文档
├── README_编号功能.md      # 📋 编号功能详细说明
├── README_姓名管理.md      # 👥 姓名管理功能说明
├── requirements.txt        # 📦 Python依赖包列表
└── performance.db          # 💾 SQLite数据库（运行时创建）
```

### 核心组件说明

#### 🚀 main.py
- **功能**: 应用程序的主入口点
- **职责**: 系统初始化、依赖检查、启动主界面
- **启动**: `python main.py`

#### 📊 database.py  
- **功能**: 数据库操作的核心模块
- **职责**: SQLite数据管理、CSV导入导出、数据一致性维护
- **测试**: `python database.py`

#### 🖥️ ui/main_window.py
- **功能**: 主窗口界面控制器
- **职责**: 整合各功能模块、菜单管理、界面布局

#### 📝 ui/data_entry_tab.py
- **功能**: 数据录入界面
- **职责**: 业绩数据录入、编号管理、姓名管理、表格操作

#### 📈 ui/charts_tab.py
- **功能**: 数据可视化界面  
- **职责**: 图表生成、趋势分析、数据对比展示

## ✨ 功能特色

### 🗄️ 数据管理
- **多时期数据录入**: 按年月半年的时期管理
- **智能编号系统**: 每个时期内人员自动编号，支持拖拽排序
- **统一姓名管理**: 下拉框选择，避免输入错误，保证数据一致性
- **自动增长计算**: 实时计算左区、右区和总增长百分比
- **🆕 上移下移优化**: 人员排序操作后姓名下拉框实时同步更新
- **🆕 空白姓名支持**: 新增行默认空白姓名，空数据自动跳过保存

### 📊 数据可视化
- **业绩趋势图**: 个人和团队业绩随时间变化趋势
- **对比分析图**: 不同人员业绩横向对比
- **增长率分析**: 可视化增长趋势和业绩波动

### 💾 数据导入导出
- **标准CSV格式**: 支持带编号的新格式，兼容旧版本数据
- **实时自动备份**: 每次数据保存时自动生成备份文件
- **数据完整性**: 确保导入导出过程中数据的完整和一致

### 🚀 智能启动
- **🆕 最新时期加载**: 程序启动时自动显示数据库中最新的业绩时期
- **🆕 PERFORMANCE_DATA专用**: 只从业绩数据表获取时期，排除汇总数据
- **🆕 格式自动转换**: 支持旧格式到新格式的自动转换

## 🔧 开发模式

### 调试运行
```bash
# 测试数据库功能
python database.py

# 直接运行界面模块（调试用）
python ui/main_window.py
```

### 数据文件
- `performance.db` - 主数据库文件（自动创建）
- `performance_backup.csv` - 自动备份文件
- `backup_YYYYMMDD_HHMMSS.csv` - 手动备份文件

## 📋 使用指南

### 数据录入流程
1. **自动时期选择** → 程序启动时自动选择最新时期
2. **管理人员** → 使用"添加新人员"功能增加员工
3. **录入数据** → 在表格中输入业绩和订单数据  
4. **调整排序** → 使用上移/下移按钮调整人员顺序
5. **保存数据** → 点击"保存数据"完成录入

### 🆕 v1.1 新功能使用
- **空白姓名处理**: 新增行默认显示空白姓名，无需手动清空
- **智能排序**: 上移下移后姓名下拉框自动同步，无需手动刷新
- **最新时期**: 每次启动自动跳转到最新的业绩数据时期

### 图表分析
1. 切换到"图表分析"标签页
2. 选择要分析的人员
3. 查看业绩趋势和增长率图表

### 数据管理
- **自动备份**: 每次保存时自动生成 `performance_backup.csv`
- **手动备份**: 文件菜单 → 备份数据
- **数据导入**: 文件菜单 → 导入CSV数据

## 🎯 版本信息

**当前版本**: v1.1  
**作者**: xilin_qian  
**更新内容**:
- ✅ 新增智能编号管理系统
- ✅ 完善统一姓名管理功能  
- ✅ 优化CSV导入导出格式
- ✅ 改进数据一致性验证
- ✅ 统一程序入口点(main.py)
- ✅ **v1.1新增**: 上移下移功能优化
- ✅ **v1.1新增**: 空白姓名选项支持
- ✅ **v1.1新增**: 最新时期自动加载
- ✅ **v1.1新增**: 姓名下拉框实时同步

## 📞 技术支持

遇到问题时请检查：
1. 控制台输出的错误信息
2. 确保所有依赖包正确安装
3. 检查数据库文件访问权限
4. 参考详细功能说明文档